<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSafe Kids - AI Tutor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;

            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            overflow-x: hidden;
            cursor: none;
            min-height: 100vh;
        }

        #custom-cursor {
            position: fixed;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, #4299e1, #1e40af);
            border-radius: 50%;
            pointer-events: none;
            z-index: 10000;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px rgba(66, 153, 225, 0.7);
        }

        #three-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .container {
            position: relative;
            z-index: 2;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            animation: slideDown 1s ease-out;
        }

        .title {
            font-size: 2.2rem;
            color: #fff;
            text-shadow: 0 0 10px rgba(66, 153, 225, 0.8);
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite alternate;
            white-space: nowrap;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #e0e6ed;
            margin-bottom: 20px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .tutor-container {
            position: fixed;
            top: 140px;
            right: 50px;
            z-index: 5;
            animation: float 3s ease-in-out infinite;
        }

        .penguin-captain {
            width: 220px;
            height: 320px;
            position: relative;
        }

        .penguin-head {
            width: 150px;
            height: 140px;
            background: #333;
            border-radius: 80% 80% 80% 80%;
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2;
        }

        .penguin-body {
            width: 180px;
            height: 200px;
            background: #333;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            overflow: hidden;
        }

        .penguin-body:after {
            content: "";
            position: absolute;
            width: 140px;
            height: 180px;
            background: white;
            border-radius: 50%;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .captain-hat {
            width: 160px;
            height: 50px;
            background: #0b5394;
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 10px 10px 0 0;
            z-index: 1;
        }

        .captain-hat:after {
            content: "";
            position: absolute;
            width: 30px;
            height: 30px;
            background: gold;
            border-radius: 50%;
            top: 10px;
            left: 65px;
            box-shadow: 0 0 15px gold;
        }

        .penguin-wings {
            position: absolute;
            width: 40px;
            height: 120px;
            background: #333;
            bottom: 40px;
            border-radius: 50%;
            z-index: 3;
        }

        .penguin-wings:before {
            content: "";
            position: absolute;
            left: 140px;
            width: 40px;
            height: 120px;
            background: #333;
            border-radius: 50%;
        }

        .captain-badge {
            width: 40px;
            height: 40px;
            background: gold;
            position: absolute;
            border-radius: 50%;
            bottom: 60px;
            left: 70px;
            z-index: 4;
            box-shadow: 0 0 10px gold;
        }

        .eye {
            position: absolute;
            width: 30px;
            height: 30px;
            background: white;
            border-radius: 50%;
            top: 50px;
            z-index: 3;
        }

        .left-eye {
            left: 35px;
        }

        .right-eye {
            right: 35px;
        }

        .eyeball {
            position: absolute;
            width: 15px;
            height: 15px;
            background: #111;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.1s ease;
        }

        .penguin-beak {
            position: absolute;
            width: 50px;
            height: 20px;
            background: #f59e0b;
            border-radius: 40% 40% 60% 60%;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 3;
        }

        .penguin-mouth {
            position: absolute;
            width: 30px;
            height: 5px;
            border: 2px solid #111;
            border-top: none;
            border-radius: 0 0 15px 15px;
            bottom: 18px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 4;
            transition: all 0.3s ease;
        }

        .speaking {
            height: 15px;
            animation: talk 0.3s ease-in-out infinite alternate;
        }

        @keyframes talk {
            from { height: 5px; }
            to { height: 15px; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .score-board {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            z-index: 10;
            border: 3px solid #f093fb;
            min-width: 200px;
            margin: 0 auto 20px auto;
            text-align: center;
        }

        .score {
            font-size: 1.8rem;
            color: #fff;
            margin-bottom: 15px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .badge {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            animation: pulse 2s infinite;
            border: 2px solid #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .questions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            padding: 0 20px;
        }

        .question-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            transform: translateY(0);
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
        }

        .question-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s ease;
        }

        .question-card:hover::before {
            left: 100%;
        }

        .question-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
            border-color: #f093fb;
        }

        .question-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .question-text {
            font-size: 1.1rem;
            color: #fff;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .answer-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .answer-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.5s ease;
            border: 3px solid #f093fb;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: #ff6b6b;
            transition: transform 0.2s ease;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            transform: scale(1.2);
            background: rgba(255,255,255,0.3);
        }

        .answer-text {
            font-size: 1.2rem;
            line-height: 1.6;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .speak-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
            border: 2px solid #fff;
        }

        .speak-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.6);
        }

        .ai-chat {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            z-index: 100;
            transition: all 0.3s ease;
            border: 3px solid #f093fb;
        }

        .ai-chat.minimized {
            height: 60px;
            overflow: hidden;
        }

        .ai-header {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            padding: 15px;
            border-radius: 20px 20px 0 0;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            font-weight: bold;
        }

        .ai-messages {
            height: 200px;
            overflow-y: auto;
            padding: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .ai-input-container {
            padding: 15px;
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex: 1;
            padding: 10px;
            border: 2px solid #f093fb;
            border-radius: 20px;
            outline: none;
            background: rgba(255,255,255,0.9);
        }

        .ai-send {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            border: 2px solid #fff;
            transition: all 0.2s ease;
        }

        .ai-send:hover {
            transform: translateY(-1px);
        }

        .message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 10px;
            animation: messageSlide 0.3s ease;
        }

        .user-message {
            background: rgba(240, 147, 251, 0.3);
            color: white;
            margin-left: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .ai-message {
            background: rgba(255,255,255,0.2);
            color: white;
            margin-right: 20px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 8px;
            background: linear-gradient(90deg, #f093fb, #f5576c, #4ecdc4);
            transition: width 0.3s ease;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(240, 147, 251, 0.6);
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f093fb;
            animation: confetti-fall 3s linear infinite;
        }

        .confetti-piece:nth-child(1) { left: 10%; animation-delay: 0s; background: #f093fb; }
        .confetti-piece:nth-child(2) { left: 20%; animation-delay: 0.1s; background: #f5576c; }
        .confetti-piece:nth-child(3) { left: 30%; animation-delay: 0.2s; background: #4ecdc4; }
        .confetti-piece:nth-child(4) { left: 40%; animation-delay: 0.3s; background: #45b7d1; }
        .confetti-piece:nth-child(5) { left: 50%; animation-delay: 0.4s; background: #f9ca24; }
        .confetti-piece:nth-child(6) { left: 60%; animation-delay: 0.5s; background: #f0932b; }
        .confetti-piece:nth-child(7) { left: 70%; animation-delay: 0.6s; background: #eb4d4b; }
        .confetti-piece:nth-child(8) { left: 80%; animation-delay: 0.7s; background: #6c5ce7; }
        .confetti-piece:nth-child(9) { left: 90%; animation-delay: 0.8s; background: #a29bfe; }
        .confetti-piece:nth-child(10) { left: 15%; animation-delay: 0.9s; background: #fd79a8; }
        .confetti-piece:nth-child(11) { left: 25%; animation-delay: 1s; background: #fdcb6e; }
        .confetti-piece:nth-child(12) { left: 35%; animation-delay: 1.1s; background: #00cec9; }

        .celebration-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.5s ease;
        }

        .celebration-content {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 50px;
            border-radius: 30px;
            border: 5px solid #f093fb;
            box-shadow: 0 20px 60px rgba(240, 147, 251, 0.4);
            animation: bounceIn 0.8s ease;
        }

        .celebration-title {
            font-size: 3rem;
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .celebration-message {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.6;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .celebration-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
            border: 3px solid #fff;
            font-weight: bold;
        }

        .celebration-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(240, 147, 251, 0.6);
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }
            50% {
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes glow {
            0% { text-shadow: 0 0 10px rgba(66, 153, 225, 0.8); }
            50% { text-shadow: 0 0 20px rgba(66, 153, 225, 0.8), 0 0 30px rgba(66, 153, 225, 0.6); }
            100% { text-shadow: 0 0 10px rgba(66, 153, 225, 0.8); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes messageSlide {
            from { transform: translateX(50px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @media (max-width: 768px) {
            .tutor-container {
                position: relative;
                top: 0;
                right: 0;
                display: flex;
                justify-content: center;
                margin: 20px 0;
            }

            .ai-chat {
                width: 90%;
                bottom: 10px;
                right: 5%;
            }

            .questions-grid {
                grid-template-columns: 1fr;
                padding: 0 10px;
            }

            .title {
                font-size: 1.8rem;
            }

            .score-board {
                margin: 20px auto;
                width: fit-content;
            }
        }
    </style>
</head>
<body>
    <div id="custom-cursor"></div>
    <div id="three-container"></div>
    
    <div class="container">
        <div class="header">
            <h1 class="title">üêß Hello There, I'm Your Cyber Captain Penguin</h1>
            <p class="subtitle">Welcome aboard! Let's learn online safety together!</p>
        </div>

        <div class="score-board">
            <div class="score">Score: <span id="score">0</span></div>
            <div class="badges" id="badges"></div>
        </div>

        <div class="tutor-container">
            <div class="penguin-captain" id="tutor">
                <div class="penguin-head">
                    <div class="captain-hat"></div>
                    <div class="eye left-eye">
                        <div class="eyeball" id="leftEyeball"></div>
                    </div>
                    <div class="eye right-eye">
                        <div class="eyeball" id="rightEyeball"></div>
                    </div>
                    <div class="penguin-beak"></div>
                    <div class="penguin-mouth" id="tutorMouth"></div>
                </div>
                <div class="penguin-body">
                    <div class="penguin-wings"></div>
                    <div class="captain-badge"></div>
                </div>
            </div>
        </div>

        <h2 style="text-align: center; color: #fff; font-size: 2rem; margin: 40px 0 30px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">üåü Here Are Some FAQs üåü</h2>

        <div class="questions-grid">
            <div class="question-card" data-question="passwords">
                <span class="question-icon">üîê</span>
                <div class="question-text">How do I create a strong password?</div>
            </div>
            
            <div class="question-card" data-question="strangers">
                <span class="question-icon">üë•</span>
                <div class="question-text">What should I do if a stranger contacts me online?</div>
            </div>
            
            <div class="question-card" data-question="personal-info">
                <span class="question-icon">üì±</span>
                <div class="question-text">What personal information should I never share?</div>
            </div>
            
            <div class="question-card" data-question="cyberbullying">
                <span class="question-icon">üö´</span>
                <div class="question-text">How do I deal with cyberbullying?</div>
            </div>
            
            <div class="question-card" data-question="downloads">
                <span class="question-icon">‚¨áÔ∏è</span>
                <div class="question-text">Is it safe to download files from the internet?</div>
            </div>
            
            <div class="question-card" data-question="social-media">
                <span class="question-icon">üì∏</span>
                <div class="question-text">How should I behave on social media?</div>
            </div>

            <div class="question-card" data-question="phishing">
                <span class="question-icon">üé£</span>
                <div class="question-text">What are phishing emails and how do I avoid them?</div>
            </div>

            <div class="question-card" data-question="gaming">
                <span class="question-icon">üéÆ</span>
                <div class="question-text">How can I stay safe while gaming online?</div>
            </div>

            <div class="question-card" data-question="wifi">
                <span class="question-icon">üì∂</span>
                <div class="question-text">Is it safe to use public WiFi?</div>
            </div>

            <div class="question-card" data-question="apps">
                <span class="question-icon">üì≤</span>
                <div class="question-text">How do I know if an app is safe to use?</div>
            </div>
        </div>
    </div>

    <div class="answer-modal" id="answerModal">
        <div class="answer-card">
            <span class="close-btn" id="closeModal">&times;</span>
            <div class="answer-text" id="answerText"></div>
            <button class="speak-btn" id="speakBtn">üîä Let Captain Penguin Read This!</button>
        </div>
    </div>

    <div class="ai-chat minimized" id="aiChat">
        <div class="ai-header" id="aiHeader">
            <span>üêß Ask Captain Penguin</span>
            <span id="toggleChat">üí¨</span>
        </div>
        <div class="ai-messages" id="aiMessages">
            <div class="message ai-message">
                Ahoy! I'm Captain Penguin. Ask me any question about online safety!
            </div>
        </div>
        <div class="ai-input-container">
            <input type="text" class="ai-input" id="aiInput" placeholder="Ask me anything...">
            <button class="ai-send" id="aiSend">Send</button>
        </div>
    </div>

    <div class="celebration-modal" id="celebrationModal">
        <div class="celebration-content">
            <div class="celebration-title">üéâ AMAZING! üéâ</div>
            <div class="celebration-message">
                Congratulations, brave cyber explorer! üåü<br>
                You've successfully learned all 10 super important online safety lessons! üèÜ<br>
                Captain Penguin is so proud of you! üêßüíô<br>
                You're now a certified Cyber Safety Hero! üõ°Ô∏è‚ú®
            </div>
            <button class="celebration-btn" id="celebrationBtn">Continue Learning! üöÄ</button>
        </div>
    </div>

    <div class="confetti" id="confetti" style="display: none;">
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
    </div>

    <div class="progress-bar" id="progressBar" style="width: 0%"></div>

    <script>
        // Three.js Scene Setup for floating stickers
        let scene, camera, renderer, particles = [];

        function initThreeJS() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('three-container').appendChild(renderer.domElement);

            // Create floating stickers
            const stickerShapes = [
                // Star shape
                new THREE.RingGeometry(1, 3, 5),
                // Heart shape (using circles)
                new THREE.CircleGeometry(2, 8),
                // Snowflake (using plane with texture)
                new THREE.PlaneGeometry(4, 4),
                // Fish shape
                new THREE.ConeGeometry(2, 5, 8),
                // Shield shape
                new THREE.CylinderGeometry(2, 3, 1, 6)
            ];

            const stickerColors = [
                0xff6b6b, // Red
                0x4ecdc4, // Teal
                0x45b7d1, // Blue
                0xf9ca24, // Yellow
                0xf0932b, // Orange
                0xeb4d4b, // Dark Red
                0x6c5ce7, // Purple
                0xa29bfe, // Light Purple
                0xfd79a8, // Pink
                0xfdcb6e, // Light Orange
                0x00cec9, // Cyan
                0xe17055  // Coral
            ];

            // Create 30 floating stickers
            for (let i = 0; i < 30; i++) {
                const geometryIndex = Math.floor(Math.random() * stickerShapes.length);
                const colorIndex = Math.floor(Math.random() * stickerColors.length);
                
                const material = new THREE.MeshBasicMaterial({ 
                    color: stickerColors[colorIndex],
                    transparent: true,
                    opacity: 0.6,
                    side: THREE.DoubleSide
                });

                const particle = new THREE.Mesh(stickerShapes[geometryIndex], material);
                
                particle.position.x = (Math.random() - 0.5) * 200;
                particle.position.y = (Math.random() - 0.5) * 200;
                particle.position.z = (Math.random() - 0.5) * 200;
                
                particle.velocity = {
                    x: (Math.random() - 0.5) * 0.1,
                    y: (Math.random() - 0.5) * 0.1,
                    z: (Math.random() - 0.5) * 0.1
                };
                
                particles.push(particle);
                scene.add(particle);
            }

            camera.position.z = 50;
            animate();
        }

        function animate() {
            requestAnimationFrame(animate);

            particles.forEach(particle => {
                particle.position.x += particle.velocity.x;
                particle.position.y += particle.velocity.y;
                particle.position.z += particle.velocity.z;
                
                particle.rotation.x += 0.02;
                particle.rotation.y += 0.02;
                particle.rotation.z += 0.01;

                // Boundary check with smooth bouncing
                if (Math.abs(particle.position.x) > 100) {
                    particle.velocity.x *= -0.8;
                    particle.position.x = Math.sign(particle.position.x) * 100;
                }
                if (Math.abs(particle.position.y) > 100) {
                    particle.velocity.y *= -0.8;
                    particle.position.y = Math.sign(particle.position.y) * 100;
                }
                if (Math.abs(particle.position.z) > 100) {
                    particle.velocity.z *= -0.8;
                    particle.position.z = Math.sign(particle.position.z) * 100;
                }
            });

            renderer.render(scene, camera);
        }

        // Eye tracking
        let mouseX = 0, mouseY = 0;

        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
            
            // Update custom cursor
            const cursor = document.getElementById('custom-cursor');
            cursor.style.left = mouseX + 'px';
            cursor.style.top = mouseY + 'px';

            // Update eyeball positions
            updateEyeballs();
        });

        function updateEyeballs() {
            const leftEye = document.getElementById('leftEyeball');
            const rightEye = document.getElementById('rightEyeball');
            
            const tutorRect = document.getElementById('tutor').getBoundingClientRect();
            const centerX = tutorRect.left + tutorRect.width / 2;
            const centerY = tutorRect.top + tutorRect.height / 3;
            
            const deltaX = mouseX - centerX;
            const deltaY = mouseY - centerY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            const maxMove = 6;
            const moveX = Math.max(-maxMove, Math.min(maxMove, (deltaX / Math.max(1, distance)) * maxMove));
            const moveY = Math.max(-maxMove, Math.min(maxMove, (deltaY / Math.max(1, distance)) * maxMove));
            
            leftEye.style.transform = `translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px))`;
            rightEye.style.transform = `translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px))`;
        }

        // Q&A System
        const answers = {
            passwords: "Great question, matey! A strong password should be at least 8 characters long and include uppercase letters, lowercase letters, numbers, and special symbols. Never use your birthday, name, or simple words. Think of a secret treasure map code that only you would know!",
            strangers: "Ahoy! If a stranger contacts you online, never give them any personal information! Tell a trusted adult right away. Don't answer their questions, don't meet them in person, and don't accept friend requests from people you don't know in real life. Remember: real friends don't ask for secrets!",
            "personal-info": "Never share your full name, address, phone number, school name, passwords, or photos online with strangers. Your personal information is like your treasure - you wouldn't give your treasure map to pirates! Always ask a trusted grown-up before sharing anything online.",
            cyberbullying: "If someone is being mean to you online, don't respond to them. Take screenshots of the mean messages, block the person, and tell a trusted adult immediately. Remember: it's not your fault, and you deserve to feel safe online. You're brave for asking for help, sailor!",
            downloads: "Only download files from websites that your parents say are safe! Many downloads can contain sneaky viruses that can hurt your computer or steal your information. Always ask an adult before downloading anything, even if it looks fun or free.",
            "social-media": "On social media, be kind to others, think before you post, and remember that everything online can be seen by many people. Don't post personal information, and if something makes you uncomfortable, talk to a trusted adult. Treat others online the same way you'd treat them in person!",
            phishing: "Phishing emails are like fake treasure maps - they look real but they're tricks! They try to steal your passwords or personal information. Never click links in emails from strangers, and always check with a trusted adult if you're unsure about an email. Real companies won't ask for your password in emails!",
            gaming: "When gaming online, never share your real name, address, or personal details with other players. Use the game's reporting system if someone is being mean. Don't click on suspicious links other players send you, and always tell a trusted adult if someone makes you uncomfortable while gaming!",
            wifi: "Public WiFi can be risky because bad people might try to see what you're doing online. It's like shouting your secrets in a crowded room! Ask a trusted adult before using public WiFi, and never enter passwords or personal information when using it. Your home WiFi is much safer!",
            apps: "Before downloading any app, ask a trusted adult to check if it's safe. Look at the app's reviews and ratings. Only download apps from official stores like Google Play or Apple App Store. Be careful about apps that ask for too many permissions or want access to your camera, location, or contacts!"
        };

        let score = 0;
        let answeredQuestions = new Set();
        let currentUtterance = null;

        document.querySelectorAll('.question-card').forEach(card => {
            card.addEventListener('click', () => {
                const questionType = card.dataset.question;
                showAnswer(questionType);
                
                if (!answeredQuestions.has(questionType)) {
                    answeredQuestions.add(questionType);
                    updateScore(10);
                    addBadge();
                    
                    // Check for celebration
                    if (score >= 100) {
                        setTimeout(showCelebration, 1000);
                    }
                }
            });
        });

        function showAnswer(questionType) {
            const modal = document.getElementById('answerModal');
            const answerText = document.getElementById('answerText');
            
            answerText.textContent = answers[questionType];
            modal.style.display = 'flex';
            
            // Store current answer for speech
            modal.dataset.currentAnswer = answers[questionType];
        }

        function updateScore(points) {
            score += points;
            document.getElementById('score').textContent = score;
            
            // Update progress bar
            const progress = Math.min((score / 100) * 100, 100);
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function addBadge() {
            const badges = document.getElementById('badges');
            const badgeEmojis = ['üèÜ', '‚≠ê', 'üéØ', 'üõ°Ô∏è', 'üí™', 'üéâ', 'üåü', 'üéä', 'üèÖ', 'üëë'];
            const badge = document.createElement('div');
            badge.className = 'badge';
            badge.style.background = `linear-gradient(135deg, hsl(${Math.random() * 360}, 70%, 60%), hsl(${Math.random() * 360}, 70%, 40%))`;
            badge.textContent = badgeEmojis[Math.floor(Math.random() * badgeEmojis.length)];
            badges.appendChild(badge);
        }

        function showCelebration() {
            const modal = document.getElementById('celebrationModal');
            const confetti = document.getElementById('confetti');
            
            modal.style.display = 'flex';
            confetti.style.display = 'block';
            
            // Stop confetti after 5 seconds
            setTimeout(() => {
                confetti.style.display = 'none';
            }, 5000);
            
            // Speak celebration message
            speakText("Congratulations, brave cyber explorer! You've successfully learned all 10 super important online safety lessons! Captain Penguin is so proud of you! You're now a certified Cyber Safety Hero!");
        }

        // Text-to-Speech
        function speakText(text) {
            // Stop any current speech
            if (currentUtterance) {
                speechSynthesis.cancel();
            }
            
            if ('speechSynthesis' in window) {
                currentUtterance = new SpeechSynthesisUtterance(text);
                currentUtterance.rate = 0.8;
                currentUtterance.pitch = 1.2;
                currentUtterance.volume = 1;
                
                const tutor = document.getElementById('tutor');
                const mouth = document.getElementById('tutorMouth');
                
                currentUtterance.onstart = () => {
                    mouth.classList.add('speaking');
                };
                
                currentUtterance.onend = () => {
                    mouth.classList.remove('speaking');
                    currentUtterance = null;
                };
                
                speechSynthesis.speak(currentUtterance);
            } else {
                alert('Sorry, your browser doesn\'t support text-to-speech!');
            }
        }

        // Modal controls
        document.getElementById('speakBtn').addEventListener('click', () => {
            const modal = document.getElementById('answerModal');
            const answer = modal.dataset.currentAnswer;
            speakText(answer);
        });

        document.getElementById('closeModal').addEventListener('click', () => {
            // Stop speech when modal is closed
            if (currentUtterance) {
                speechSynthesis.cancel();
                const mouth = document.getElementById('tutorMouth');
                mouth.classList.remove('speaking');
                currentUtterance = null;
            }
            document.getElementById('answerModal').style.display = 'none';
        });

        document.getElementById('answerModal').addEventListener('click', (e) => {
            if (e.target.id === 'answerModal') {
                // Stop speech when modal is closed
                if (currentUtterance) {
                    speechSynthesis.cancel();
                    const mouth = document.getElementById('tutorMouth');
                    mouth.classList.remove('speaking');
                    currentUtterance = null;
                }
                document.getElementById('answerModal').style.display = 'none';
            }
        });

        document.getElementById('celebrationBtn').addEventListener('click', () => {
            document.getElementById('celebrationModal').style.display = 'none';
        });

        // AI Chat System
        let aiChatMinimized = true;

        document.getElementById('aiHeader').addEventListener('click', () => {
            const chat = document.getElementById('aiChat');
            aiChatMinimized = !aiChatMinimized;
            
            if (aiChatMinimized) {
                chat.classList.add('minimized');
            } else {
                chat.classList.remove('minimized');
            }
        });

        // AI Integration
        async function sendToAI(message) {
            const messagesDiv = document.getElementById('aiMessages');
            
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'message user-message';
            userMessage.textContent = message;
            messagesDiv.appendChild(userMessage);
            
            // Add thinking indicator
            const thinkingMessage = document.createElement('div');
            thinkingMessage.className = 'message ai-message';
            thinkingMessage.textContent = 'ü§î Thinking...';
            messagesDiv.appendChild(thinkingMessage);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            try {
                const responses = [
                    "Ahoy sailor! That's a great question about online safety! Always remember to keep your personal treasure (information) secure, just like we secure our ship!",
                    "Great question, matey! Remember, when online, always tell a trusted grown-up if something makes you uncomfortable. They're your crew!",
                    "Arr, good thinking! Your personal information is your treasure - don't share it with pirates (strangers) online!",
                    "You're a smart sailor for asking! Always check with your parents before downloading anything - they're your navigators!",
                    "That's exactly what a good cyber crew member would ask! Stay safe by being kind online and treating others with respect!",
                    "Captain Penguin's tip: when in doubt, ask a trusted adult. They're your best compass in the online ocean!"
                ];
                
                // Simulate AI thinking time
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                thinkingMessage.textContent = responses[Math.floor(Math.random() * responses.length)];
                
            } catch (error) {
                thinkingMessage.textContent = "Sorry, I'm having trouble thinking right now. Try asking again, sailor!";
            }
            
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        document.getElementById('aiSend').addEventListener('click', () => {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (message) {
                sendToAI(message);
                input.value = '';
            }
        });

        document.getElementById('aiInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('aiSend').click();
            }
        });

        // Initialize everything
        window.addEventListener('load', () => {
            initThreeJS();
            
            // Stop any speech when page loads
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
            }
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Welcome speech
        setTimeout(() => {
            speakText("Ahoy there, brave sailor! I'm Captain Penguin, your cyber safety guide. Click on any question card to learn about staying safe in the digital ocean!");
        }, 2000);
    </script>
</body>
</html>